# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ø—Ä–∏–Ω—Ç–∞ D1: Build & Publish

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω

## –û–±–∑–æ—Ä

–ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è Docker –æ–±—Ä–∞–∑–æ–≤ (bot, api, frontend) –≤ GitHub Container Registry —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º GitHub Actions. –û–±—Ä–∞–∑—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø—É–±–ª–∏—á–Ω–æ –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏ (—Å–ø—Ä–∏–Ω—Ç—ã D2, D3).

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –í–≤–µ–¥–µ–Ω–∏–µ –≤ GitHub Actions ‚úÖ

–°–æ–∑–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç `devops/doc/github-actions-guide.md` —Å –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π:

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã:**
- –û—Å–Ω–æ–≤—ã GitHub Actions: workflow, job, step, runner
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ workflow —Ñ–∞–π–ª–æ–≤ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –≤ `.github/workflows/`
- –¢—Ä–∏–≥–≥–µ—Ä—ã: push, pull_request, workflow_dispatch, schedule
- Secrets –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: GITHUB_TOKEN, environment variables
- Matrix strategy –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —Å–±–æ—Ä–∫–∏
- GitHub Container Registry (ghcr.io): –ø—É–±–ª–∏–∫–∞—Ü–∏—è, public/private –¥–æ—Å—Ç—É–ø
- PR workflow: —Å–æ–∑–¥–∞–Ω–∏–µ, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, merge
- Permissions: workflow –∏ package settings
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Å–±–æ—Ä–∫–∏
- Best practices –∏ –ø—Ä–∏–º–µ—Ä—ã

### 2. GitHub Actions Workflow ‚úÖ

–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `.github/workflows/build.yml` —Å –ø–æ–ª–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π —Å–±–æ—Ä–∫–∏ –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- `push` –≤ –≤–µ—Ç–∫—É `main` ‚Üí —Å–±–æ—Ä–∫–∞ + –ø—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤
- `pull_request` ‚Üí —Ç–æ–ª—å–∫–æ —Å–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)

**Matrix strategy:**
```yaml
strategy:
  matrix:
    service: [bot, api, frontend]
    include:
      - service: bot
        dockerfile: devops/dockerfile.bot
      - service: api
        dockerfile: devops/dockerfile.api
      - service: frontend
        dockerfile: devops/dockerfile.frontend
```

**–û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ workflow:**
1. **Checkout –∫–æ–¥–∞** - `actions/checkout@v4`
2. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker Buildx** - `docker/setup-buildx-action@v3` –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
3. **–õ–æ–≥–∏–Ω –≤ ghcr.io** - `docker/login-action@v3` (—Ç–æ–ª—å–∫–æ –¥–ª—è push –≤ main)
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–≥–æ–≤** - `docker/metadata-action@v5`:
   - `latest` - –¥–ª—è main –≤–µ—Ç–∫–∏
   - `sha-<commit>` - –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–æ–º–º–∏—Ç—É
5. **Build –∏ Push** - `docker/build-push-action@v5` —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º layers

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- GitHub Actions Cache –¥–ª—è Docker layers: `cache-from: type=gha`, `cache-to: type=gha,mode=max`
- –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Å–±–æ—Ä–æ–∫ –∑–∞ —Å—á–µ—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è layers

**–£—Å–ª–æ–≤–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è:**
- Push —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `github.event_name == 'push'`
- PR —Ç–æ–ª—å–∫–æ —Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### 3. –ü—É–±–ª–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞–∑–æ–≤ ‚úÖ

**Registry:** GitHub Container Registry (`ghcr.io`)

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤:**
- `ghcr.io/${{ github.repository_owner }}/systech-aidd-bot:latest`
- `ghcr.io/${{ github.repository_owner }}/systech-aidd-api:latest`
- `ghcr.io/${{ github.repository_owner }}/systech-aidd-frontend:latest`

**–¢–µ–≥–∏:**
- `latest` - –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è –∏–∑ main (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- `sha-<commit>` - –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–æ–º–º–∏—Ç—É (–¥–ª—è –æ—Ç–∫–∞—Ç–∞)

**Public access:**
–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –æ–±—Ä–∞–∑—ã –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–º–∏:
1. GitHub ‚Üí Packages ‚Üí –í—ã–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑
2. Package settings ‚Üí Change visibility ‚Üí Public
3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ

–¢–µ–ø–µ—Ä—å –æ–±—Ä–∞–∑—ã –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
```bash
docker pull ghcr.io/OWNER/systech-aidd-bot:latest
```

### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å docker-compose ‚úÖ

–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π —Ñ–∞–π–ª `docker-compose.registry.yml` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤—ã—Ö –æ–±—Ä–∞–∑–æ–≤ –∏–∑ ghcr.io.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –°–µ—Ä–≤–∏—Å—ã `bot`, `api`, `frontend` –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—Ä–∞–∑—ã –∏–∑ registry
- `postgres` –æ—Å—Ç–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–º (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ–±—Ä–∞–∑)
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã `docker-compose.yml`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```yaml
image: ghcr.io/${GITHUB_REPOSITORY_OWNER:-yourusername}/systech-aidd-bot:latest
```

**–î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:**

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞** - —Å–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤:
```bash
docker-compose up
```

2. **–ó–∞–ø—É—Å–∫ –∏–∑ registry** - –≥–æ—Ç–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã:
```bash
docker-compose -f docker-compose.registry.yml up
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è D2/D3:**
- –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –Ω–∞ production
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –æ–±—Ä–∞–∑—ã

### 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ ‚úÖ

#### README.md
–î–æ–±–∞–≤–ª–µ–Ω—ã:
- **Badge —Å—Ç–∞—Ç—É—Å–∞ —Å–±–æ—Ä–∫–∏:** `[![Build and Publish](https://github.com/OWNER/systech-aidd/workflows/Build%20and%20Publish/badge.svg)]`
- **–°–µ–∫—Ü–∏—è "üê≥ Docker –æ–±—Ä–∞–∑—ã":**
  - –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤ –≤ ghcr.io
  - –ö–æ–º–∞–Ω–¥—ã –¥–ª—è pull –æ–±—Ä–∞–∑–æ–≤
  - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É —á–µ—Ä–µ–∑ `docker-compose.registry.yml`
  - –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –≥–æ—Ç–æ–≤—ã—Ö –æ–±—Ä–∞–∑–æ–≤

#### devops/doc/github-actions-guide.md
–°–æ–∑–¥–∞–Ω–æ –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ GitHub Actions (—Å–º. –ø—É–Ω–∫—Ç 1).

#### devops/doc/plans/sprint-d1-implementation.md
–¢–µ–∫—É—â–∏–π –¥–æ–∫—É–º–µ–Ω—Ç - –∏—Ç–æ–≥–æ–≤—ã–π –ø–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ø—Ä–∏–Ω—Ç–∞.

#### devops/doc/devops-roadmap.md
–û–±–Ω–æ–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å D1 –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–ª–∞–Ω.

### 6. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ ‚úÖ

#### GitHub Permissions

**Workflow permissions** (–¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ ghcr.io):
1. Settings ‚Üí Actions ‚Üí General ‚Üí Workflow permissions
2. –í—ã–±—Ä–∞—Ç—å: **"Read and write permissions"**
3. –í–∫–ª—é—á–∏—Ç—å: **"Allow GitHub Actions to create and approve pull requests"** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**Package visibility** (–ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø):
1. –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏: Packages ‚Üí systech-aidd-bot/api/frontend
2. Package settings ‚Üí Change visibility ‚Üí **Public**
3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `devops/doc/github-actions-guide.md` –≤ —Ä–∞–∑–¥–µ–ª–µ "Permissions".

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ—Å—Ç–æ—Ç–∞ (MVP –ø–æ–¥—Ö–æ–¥)

- **–û–¥–∏–Ω workflow —Ñ–∞–π–ª** - –≤—Å–µ —Ç—Ä–∏ –æ–±—Ä–∞–∑–∞ –≤ –æ–¥–Ω–æ–º workflow
- **Matrix strategy** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ —Ç—Ä–µ—Ö –æ–±—Ä–∞–∑–æ–≤
- **GitHub-hosted runners** - –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ Ubuntu runners
- **–ú–∏–Ω–∏–º—É–º —à–∞–≥–æ–≤** - —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ —á–µ—Ä–µ–∑ GitHub Actions Cache

### –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

1. **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:**
   - `docker-compose.yml` - —Å–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤
   - –ë—ã—Å—Ç—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–Ω—ã —Å—Ä–∞–∑—É

2. **Production/Testing:**
   - `docker-compose.registry.yml` - –≥–æ—Ç–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã
   - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç, –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

### –£—Å–ª–æ–≤–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è

- **PR:** —Ç–æ–ª—å–∫–æ —Å–±–æ—Ä–∫–∞ ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –æ–±—Ä–∞–∑—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è
- **Main:** —Å–±–æ—Ä–∫–∞ + –ø—É–±–ª–∏–∫–∞—Ü–∏—è ‚Üí –æ–±—Ä–∞–∑—ã –ø–æ–ø–∞–¥–∞—é—Ç –≤ registry

–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ "—Å—ã—Ä—ã—Ö" –æ–±—Ä–∞–∑–æ–≤.

### –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- `latest` - –≤—Å–µ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è, —É–¥–æ–±–Ω–æ –¥–ª—è development
- `sha-<commit>` - –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `.github/workflows/build.yml` - GitHub Actions workflow
2. `docker-compose.registry.yml` - compose —Ñ–∞–π–ª –¥–ª—è registry –æ–±—Ä–∞–∑–æ–≤
3. `devops/doc/github-actions-guide.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ GitHub Actions
4. `devops/doc/plans/sprint-d1-implementation.md` - –∏—Ç–æ–≥–æ–≤—ã–π –ø–ª–∞–Ω (—ç—Ç–æ—Ç —Ñ–∞–π–ª)

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `README.md` - badge –∏ —Å–µ–∫—Ü–∏—è –ø—Ä–æ Docker –æ–±—Ä–∞–∑—ã
2. `devops/doc/devops-roadmap.md` - —Å—Ç–∞—Ç—É—Å D1

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (—Å–±–æ—Ä–∫–∞ –∏–∑ –∏—Å—Ö–æ–¥–Ω–∏–∫–æ–≤)
```bash
docker-compose up -d
docker-compose logs -f
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–æ—Ç–æ–≤—ã—Ö –æ–±—Ä–∞–∑–æ–≤ –∏–∑ registry
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –∏–º–µ–Ω–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞
export GITHUB_REPOSITORY_OWNER=yourusername

# –ò–ª–∏ –≤ Windows PowerShell
$env:GITHUB_REPOSITORY_OWNER="yourusername"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –æ–±—Ä–∞–∑–∞–º–∏ –∏–∑ registry
docker-compose -f docker-compose.registry.yml up -d
```

#### –†—É—á–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ–±—Ä–∞–∑–æ–≤
```bash
docker pull ghcr.io/OWNER/systech-aidd-bot:latest
docker pull ghcr.io/OWNER/systech-aidd-api:latest
docker pull ghcr.io/OWNER/systech-aidd-frontend:latest
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ (–ø–æ commit SHA)
```bash
docker pull ghcr.io/OWNER/systech-aidd-bot:sha-abc1234
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ CI

1. **–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –≤–µ—Ç–∫—É:**
```bash
git checkout -b test/d1-workflow
git push origin test/d1-workflow
```

2. **–û—Ç–∫—Ä—ã—Ç—å Pull Request:**
- GitHub UI: "New pull request"
- Base: main ‚Üê Compare: test/d1-workflow
- Workflow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É:**
- Actions ‚Üí –í—ã–±—Ä–∞—Ç—å workflow run
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ 3 –æ–±—Ä–∞–∑–∞ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- –û–±—Ä–∞–∑—ã –ù–ï –ø—É–±–ª–∏–∫—É—é—Ç—Å—è (—ç—Ç–æ PR)

4. **Merge –≤ main:**
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏: "Merge pull request"
- Workflow –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Å–Ω–æ–≤–∞
- –û–±—Ä–∞–∑—ã —Å–æ–±–µ—Ä—É—Ç—Å—è –ò –æ–ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ ghcr.io

### –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:

```bash
# –°–¥–µ–ª–∞—Ç—å –æ–±—Ä–∞–∑—ã –ø—É–±–ª–∏—á–Ω—ã–º–∏ (—Å–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤—ã—à–µ)

# –°–∫–∞—á–∞—Ç—å –æ–±—Ä–∞–∑—ã
docker pull ghcr.io/OWNER/systech-aidd-bot:latest
docker pull ghcr.io/OWNER/systech-aidd-api:latest
docker pull ghcr.io/OWNER/systech-aidd-frontend:latest

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ docker-compose.registry.yml
export GITHUB_REPOSITORY_OWNER=OWNER
docker-compose -f docker-compose.registry.yml up -d

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker-compose -f docker-compose.registry.yml logs -f

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
# Frontend: http://localhost:3000
# API: http://localhost:8000/docs
```

## –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Å–ª–µ–¥—É—é—â–∏–º —Å–ø—Ä–∏–Ω—Ç–∞–º

### D2: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (—Ä—É—á–Ω–æ–µ)

‚úÖ –û–±—Ä–∞–∑—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ ghcr.io
‚úÖ –û–±—Ä–∞–∑—ã –ø—É–±–ª–∏—á–Ω—ã–µ - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
‚úÖ `docker-compose.registry.yml` –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
‚úÖ –¢–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ `latest` –∏ `sha-<commit>` –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è D2:**
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä—É—á–Ω–æ–º—É –¥–µ–ø–ª–æ—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å `docker-compose.registry.yml` –∏ `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –í—ã–ø–æ–ª–Ω–∏—Ç—å `docker-compose -f docker-compose.registry.yml up -d`

### D3: Auto Deploy

‚úÖ CI —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
‚úÖ –û–±—Ä–∞–∑—ã –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
‚úÖ –ï—Å—Ç—å –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å GitHub Actions

**–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è D3:**
- –î–æ–±–∞–≤–∏—Ç—å workflow –¥–ª—è –¥–µ–ø–ª–æ—è —Å `workflow_dispatch`
- SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
- Pull –æ–±—Ä–∞–∑–æ–≤ –∏ restart —Å–µ—Ä–≤–∏—Å–æ–≤
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GitHub secrets (SSH_KEY, HOST, USER)

## MVP —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è - –≤—ã–ø–æ–ª–Ω–µ–Ω–æ

‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –æ–¥–∏–Ω workflow —Ñ–∞–π–ª, matrix strategy
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞** - –ø—Ä–∏ push –≤ main
‚úÖ **–ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ ghcr.io** - —á–µ—Ä–µ–∑ GITHUB_TOKEN
‚úÖ **Public access** - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ visibility
‚úÖ **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ D2/D3** - –æ–±—Ä–∞–∑—ã –¥–æ—Å—Ç—É–ø–Ω—ã, compose —Ñ–∞–π–ª –≥–æ—Ç–æ–≤
‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º** - –≤—Å–µ —Ñ–∞–π–ª—ã —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

‚ùå **–ù–µ –≤–∫–ª—é—á–µ–Ω–æ (–∫–∞–∫ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–æ—Å—å):**
- Lint checks (–¥–æ–±–∞–≤–∏–º –ø–æ–∑–∂–µ)
- –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (–¥–æ–±–∞–≤–∏–º –ø–æ–∑–∂–µ)
- Security scanning (–¥–æ–±–∞–≤–∏–º –ø–æ–∑–∂–µ)
- Multi-platform builds (–¥–æ–±–∞–≤–∏–º –ø–æ–∑–∂–µ)

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–°–ø—Ä–∏–Ω—Ç D1 –∑–∞–≤–µ—Ä—à–µ–Ω. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ `devops/doc/plans/sprint-d1-implementation.md`.

**–û–±–Ω–æ–≤–∏—Ç—å roadmap:**
- ‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å D1 –Ω–∞ "‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω"
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø–ª–∞–Ω: `[–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](plans/sprint-d1-implementation.md)`

**–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º D2:**
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤—É—é –ø—É–±–ª–∏–∫–∞—Ü–∏—é –æ–±—Ä–∞–∑–æ–≤ (push –≤ main)
2. –°–¥–µ–ª–∞—Ç—å –æ–±—Ä–∞–∑—ã –ø—É–±–ª–∏—á–Ω—ã–º–∏ —á–µ—Ä–µ–∑ GitHub UI
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π pull –∏ –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `docker-compose.registry.yml`
4. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ badge –≤ README –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ D2:**
- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É (SSH –∫–ª—é—á–∏, IP –∞–¥—Ä–µ—Å)
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É (–û–°, Docker, —Ä–µ—Å—É—Ä—Å—ã)
- –°–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —à–∞–±–ª–æ–Ω `.env.production`

