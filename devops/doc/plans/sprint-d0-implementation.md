# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–ø—Ä–∏–Ω—Ç–∞ D0: Basic Docker Setup

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω

## –û–±–∑–æ—Ä

–ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (Bot, API, Frontend, PostgreSQL) —á–µ—Ä–µ–∑ docker-compose –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ Dockerfiles ‚úÖ

–°–æ–∑–¥–∞–Ω—ã –ø—Ä–æ—Å—Ç—ã–µ Dockerfile –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `devops/`:

**devops/dockerfile.bot**
- Base image: `python:3.11-slim`
- Package manager: UV
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `pyproject.toml` –∏ `uv.lock`
- –ö–æ–ø–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥–Ω–∏–∫–∏: `src/`, `backend/`
- CMD: `uv run python -m src.main`

**devops/dockerfile.api**
- Base image: `python:3.11-slim`
- Package manager: UV
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `pyproject.toml` –∏ `uv.lock`
- –ö–æ–ø–∏—Ä—É–µ—Ç –∏—Å—Ö–æ–¥–Ω–∏–∫–∏: `backend/`, `src/`, `migrations/`
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç 8000
- CMD: `uv run python -m backend.api`

**devops/dockerfile.frontend**
- Base image: `node:20-alpine`
- Package manager: pnpm
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ `frontend/package.json`
- –°–æ–±–∏—Ä–∞–µ—Ç production build: `pnpm build`
- –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç 3000
- CMD: `pnpm start`

### 2. –°–æ–∑–¥–∞–Ω–∏–µ .dockerignore ‚úÖ

–°–æ–∑–¥–∞–Ω –µ–¥–∏–Ω—ã–π `.dockerignore` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ:
- Python –∫—ç—à–∏ (__pycache__, .pytest_cache, .mypy_cache, .ruff_cache)
- Node –∫—ç—à–∏ (node_modules, .next)
- –¢–µ—Å—Ç—ã, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è, Git —Ñ–∞–π–ª—ã
- Dev-—Ñ–∞–π–ª—ã (.vscode, .cursor)

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ docker-compose.yml ‚úÖ

–û–±–Ω–æ–≤–ª–µ–Ω `docker-compose.yml` —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Ç—Ä–µ—Ö –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

**postgres** (–æ–±–Ω–æ–≤–ª–µ–Ω):
- –î–æ–±–∞–≤–ª–µ–Ω volume –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π: `./migrations:/docker-entrypoint-initdb.d:ro`
- Healthcheck –¥–ª—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

**bot** (–Ω–æ–≤—ã–π):
- –°–±–æ—Ä–∫–∞ –∏–∑ `devops/dockerfile.bot`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `.env` –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç postgres —Å —É—Å–ª–æ–≤–∏–µ–º `service_healthy`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫: `unless-stopped`

**api** (–Ω–æ–≤—ã–π):
- –°–±–æ—Ä–∫–∞ –∏–∑ `devops/dockerfile.api`
- –ü–æ—Ä—Ç: 8000:8000
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `.env` –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç postgres —Å —É—Å–ª–æ–≤–∏–µ–º `service_healthy`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫: `unless-stopped`

**frontend** (–Ω–æ–≤—ã–π):
- –°–±–æ—Ä–∫–∞ –∏–∑ `devops/dockerfile.frontend`
- –ü–æ—Ä—Ç: 3000:3000
- Environment: `NEXT_PUBLIC_API_URL=http://localhost:8000`
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç api
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫: `unless-stopped`

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î ‚úÖ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º PostgreSQL:
- –í —Å–µ—Ä–≤–∏—Å–µ `postgres` –¥–æ–±–∞–≤–ª–µ–Ω volume: `./migrations:/docker-entrypoint-initdb.d:ro`
- PostgreSQL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç SQL —Ñ–∞–π–ª—ã –∏–∑ `/docker-entrypoint-initdb.d/` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
- –ú–∏–≥—Ä–∞—Ü–∏—è `001_init_schema.sql` –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 5. –°–æ–∑–¥–∞–Ω–∏–µ .env.example ‚úÖ

–°–æ–∑–¥–∞–Ω —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è `.env.example` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏: `TELEGRAM_BOT_TOKEN`, `OPENROUTER_API_KEY`
- PostgreSQL –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è Docker: `POSTGRES_HOST=postgres`
- LLM –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- Frontend API URL: `NEXT_PUBLIC_API_URL=http://localhost:8000`

### 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README.md ‚úÖ

–î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Å–µ–∫—Ü–∏—è "üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞" —Å –¥–≤—É–º—è –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –∑–∞–ø—É—Å–∫–∞:

**üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
- –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏–∑ 3 —à–∞–≥–æ–≤
- –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏ (up, down, build, logs, restart)
- –£–∫–∞–∑–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å–∞–º

**üíª –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–±–µ–∑ Docker):**
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å UV
- –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ PostgreSQL —á–µ—Ä–µ–∑ Docker
- –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `POSTGRES_HOST=localhost`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ—Å—Ç–æ—Ç–∞ (MVP –ø–æ–¥—Ö–æ–¥)
- –û–¥–Ω–æ—Å–ª–æ–π–Ω—ã–µ Dockerfile –±–µ–∑ multi-stage builds
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ volume
- –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —á–µ—Ä–µ–∑ .env —Ñ–∞–π–ª
- –ú–∏–Ω–∏–º—É–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
```
postgres (healthcheck)
    ‚Üì
bot, api (depends_on: postgres)
    ‚Üì
frontend (depends_on: api)
```

### –°–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- –í–Ω—É—Ç—Ä–∏ Docker: —Å–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∞–º (`postgres`, `api`)
- –°–Ω–∞—Ä—É–∂–∏ Docker: –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ localhost:–ø–æ—Ä—Ç
- Frontend –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞: `NEXT_PUBLIC_API_URL=http://localhost:8000`

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `devops/dockerfile.bot`
- `devops/dockerfile.api`
- `devops/dockerfile.frontend`
- `.dockerignore`
- `.env.example`
- –û–±–Ω–æ–≤–ª–µ–Ω `docker-compose.yml`
- –û–±–Ω–æ–≤–ª–µ–Ω `README.md`

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞

```bash
# –°–æ–∑–¥–∞—Ç—å .env –∏–∑ —à–∞–±–ª–æ–Ω–∞
cp .env.example .env

# –ó–∞–ø–æ–ª–Ω–∏—Ç—å TELEGRAM_BOT_TOKEN –∏ OPENROUTER_API_KEY –≤ .env

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose up

# –ò–ª–∏ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
docker-compose up -d
```

### –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º
- Frontend: http://localhost:3000
- API: http://localhost:8000/docs
- PostgreSQL: localhost:5432

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker Desktop ‚úÖ
2. –°–æ–∑–¥–∞—Ç—å `.env` —Ñ–∞–π–ª —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏ ‚úÖ
3. –í—ã–ø–æ–ª–Ω–∏—Ç—å `docker-compose build` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–æ–≤ ‚úÖ
4. –í—ã–ø–æ–ª–Ω–∏—Ç—å `docker-compose up` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ ‚úÖ
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `docker-compose logs -f` ‚úÖ
6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:
   - PostgreSQL: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î ‚úÖ
   - Bot: —Ä–∞–±–æ—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ POSTGRES_HOST –≤ .env
   - API: —Ä–∞–±–æ—Ç–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ POSTGRES_HOST –≤ .env
   - Frontend: –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ ‚úÖ

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤:** ‚úÖ –£—Å–ø–µ—à–Ω–æ
- Bot: —Å–æ–±—Ä–∞–Ω –∑–∞ ~5 —Å–µ–∫—É–Ω–¥ (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤)
- API: —Å–æ–±—Ä–∞–Ω –∑–∞ ~5 —Å–µ–∫—É–Ω–¥ (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤)  
- Frontend: —Å–æ–±—Ä–∞–Ω –∑–∞ ~2 –º–∏–Ω—É—Ç—ã (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ node_modules)

**–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤:** ‚úÖ –£—Å–ø–µ—à–Ω–æ
- PostgreSQL: –∑–∞–ø—É—â–µ–Ω, healthcheck –ø—Ä–æ—Ö–æ–¥–∏—Ç
- Bot: –∑–∞–ø—É—â–µ–Ω, –∂–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- API: –∑–∞–ø—É—â–µ–Ω, –∂–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- Frontend: –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 3000

**–í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
Bot –∏ API —Ç—Ä–µ–±—É—é—Ç `POSTGRES_HOST=postgres` –≤ `.env` —Ñ–∞–π–ª–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ Docker.
–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `POSTGRES_HOST=localhost`.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞ –∑–∞–ø—É—Å–∫–∞.

### –ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs api
docker-compose logs bot
docker-compose logs frontend
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–°–ø—Ä–∏–Ω—Ç D0 –∑–∞–≤–µ—Ä—à–µ–Ω. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ `devops/doc/plans/sprint-d0-implementation.md`.

–û–±–Ω–æ–≤–∏—Ç—å roadmap:
- –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å D0 –Ω–∞ "‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω"
- –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø–ª–∞–Ω: `[–ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏](plans/sprint-d0-implementation.md)`

